!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SmartContext={},e.React)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=n(t);const o={},c=(e,t,n,a)=>{const{debug:c}=o[e];c&&((e,t,n)=>{console[e]("::SMART-CONTEXT::DEBUG:: ".concat(t),n)})(t,n,a)},i=(e,t)=>n=>"object"!=typeof n&&"RESET"!==e?(c(t,"error","Invalid action call. Payload must be an object",{contextName:t,type:e,payload:n}),null):o[t].dispatch({type:e,payload:n,contextName:t}),r=(e,t)=>{const n={},a={},r={};return Object.keys(e).forEach((o=>{const c=o.replace(/([a-z0-9])([A-Z])/g,"$1_$2").toUpperCase();const s=e[o];var d;"function"==typeof s?(n[c]={handler:s},a[o]=i(c,t)):(d=s,Array.isArray(d)&&d.every((e=>"string"==typeof e))?(n[c]={keys:s},a[o]=i(c,t)):r[o]=s)})),n.RESET={keys:[]},a.reset=i("RESET",t),Object.keys(r).length&&c(t,"error","Invalid actions found in config. They are ignored.",{contextName:t,inValidActions:r}),o[t].actionTypes=n,{actions:a}},s=(e,t)=>{const{type:n,payload:a,contextName:i}=t,{actionTypes:r,getInitialState:s}=o[i];if("RESET"===n)return s();const d={},l={};return r[n].keys.forEach((t=>{t in a?d[t]=a[t]:(d[t]=e[t],l[n]={payload:a,contextName:i}),Object.keys(l).length&&c(i,"warn","Unknown keys in action payload are ignored",{contextName:i,ignoredKeys:l})})),{...e,...d}},d=({actionsConfig:e={},initialState:t={},debug:n=!1,displayName:a})=>{o[a]={getInitialState:()=>JSON.parse(JSON.stringify(t)),debug:n};const{actions:i}=r(e,a),{reducer:d,initialState:l}=(e=>({reducer:(t,n)=>{try{const{type:a}=n,{actionTypes:i}=o[e],r=(i[a].handler||s)(t,n);return c(e,"log","Action Dispatch Success",{contextName:e,action:n,newState:r}),r}catch(a){return c(e,"error","Action Dispatch Failed",{contextName:e,action:n,error:{message:"Error in reducer. Check action config and dispatch call."}}),t}},initialState:o[e].getInitialState()}))(a);return{contextName:a,actions:i,reducer:d,initialState:l}};e.getContext=e=>o[e]?o[e].context:{error:"Context ".concat(e," not found")},e.initContext=(e={})=>{const{displayName:n}=e,c=(e=>"string"!=typeof e||""===e?"Context name not valid: ".concat(e):!!o[e]&&"Context already initialized: ".concat(e))(n);if(c)return c;const{contextName:i,actions:r,reducer:s,initialState:l}=d(e),u=t.createContext({});u.displayName=i,(e=>{const{displayName:t}=e;o[t].context=e})(u);return({children:e})=>{const[n,c]=t.useReducer(s,l);t.useEffect((()=>{((e,t)=>{o[e].dispatch=t})(i,c)}),[]);const d={state:n,actions:r};return a.default.createElement(u.Provider,{value:d},e)}},Object.defineProperty(e,"__esModule",{value:!0})}));
